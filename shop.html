<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="./assets/css/shop.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <title>Shop</title>
</head>
<style>
            .error {
      background-color: rgba(220, 53, 69, 0.1);
      color: red;
      display: block;
    }
        .message {
      margin-top: 15px;
      padding: 12px;
      border-radius: 8px;
      font-weight: 500;
      font-size: 0.9rem;
      display: none;
    }
    .switchButtons button {
        transition: opacity 0.3s ease-in-out, background-color 0.3s ease-in-out;
    }
    
    .switchButtons button.active {
        opacity: 1;
    }
    
    .switchButtons button:not(.active) {
        opacity: 0.6;
    }
    
    .formContainer {
        display: none;
    }
    
    #registerForm {
        display: block;
    }
    
    .sidebar {
        display: none;
    }
    .openbtn {
        display: none;
    }
    
    .overlaytus {
        display: none;
    }
    
    .sidebar {
      height: 100vh;
      width: 0;
      position: fixed;
      z-index: 5;
      top: -10px;
      left: 0;
      background-color: rgba(32, 129, 83, 0.9);
      overflow-x: hidden;
      transition: 0.5s;
      padding-top: 60px;
      color: white;
    
      
    }
    .sidebar-button {
        padding: 15px;
        font-size: 18px;
        border: none;
        border-radius: 100px;
        background-color: #F07E26;
        font-weight: 600;
        font-size: 20px;
        line-height: 100%;
        letter-spacing: 0%;
        color: white;
        margin-top: auto; /* Чтобы кнопка всегда была внизу */
        position: absolute;
        bottom: 130px !important;
        left: 20px;
    }
    .sidebar a {
      padding: 10px 30px;
      text-decoration: none;
      font-size: 22px;
      color: white;
      display: block;
      transition: 0.3s;
    }
    
    .sidebar a:hover {
      background-color: rgba(19, 125, 59, 0.95);
    }
    
    .sidebar .closebtn_first {
      position: absolute;
      top: 20px;
      right: 25px;
      font-size: 36px;
    }
    
    .openbtn {
      font-size: 30px;
      cursor: pointer;
      color: #383C38;
      padding: 10px 15px;
      border: none;
      margin: 10px;
      background-color: transparent;
    }
    
    .overlaytus {
      position: fixed;
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      opacity: 0;
      visibility: hidden;
      transition: 0.5s;
      z-index: 1;
    }
    
    /* Когда меню открыто */
    .sidebar.open {
      width: 100%; /* или 70%, чтобы не на всю ширину */
    }
    .overlaytus.show {
      opacity: 1;
      visibility: visible;
    }
    .language-dropdown {
      position: relative;
        margin-left: 20px;
    }
    
    .language-btn {
      background: none;
      border: none;
      color: white;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      padding: 5px 0;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 10px;
    }
    
    .language-menu {
      opacity: 0;
      transform: translateY(-10px);
      pointer-events: none;
      transition: opacity 0.3s ease, transform 0.3s ease;
      position: absolute;
      top: 100%;
      left: 0;
      background-color: rgba(32, 129, 83, 0.95);
      border: 1px solid #ccc;
      margin-top: 8px;
      padding: 10px;
      border-radius: 8px;
      flex-direction: column;
      gap: 10px;
      z-index: 5;
    }
    
    .language-menu a {
      color: white;
      text-decoration: none;
      font-size: 16px;
    }
    
    .language-menu a:hover {
      text-decoration: underline;
    }
    
    /* Когда открыто */
    .language-dropdown.open .language-menu {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
      display: flex; /* Уже у тебя стоит — оставляем */
    }
    .sidebar-links {
        margin-top: 50px;
    }
    
    .arrow-icon {
      transition: transform 0.3s ease;
    }
    
    /* Когда открыто — поворачиваем стрелку вверх */
    .language-dropdown.open .arrow-icon {
      transform: rotate(180deg);
    }
    
    </style>
<body>
    <header>
        <nav class="navbar">
            <div class="logoDiv">
                <a href="./index.html">
                    <img class="logoHeaderSize" src="./assets/img/logo.png" alt="logo">
                </a>
            </div>
            <div class="othercontrols">
                <a href="./index.html">Ana səhifə</a>
                <a href="#">Mağaza</a>
                <a href="./aboutUs.html">Haqqımızda</a>
                <a href="./contact.html">Bizimlə əlaqə</a>
                <a href="./cart.html">
                    <img src="./assets/img/cart.png" alt="cart">
                </a>
                <a href="#">
                    <img src="./assets/img/language.png" alt="language">
                </a>
                        <div id="authControl">
            <button class="signIn" id="modalPage">Daxil ol</button>
            </div>
            </div>
    
            <div class="overlaytus" id="overlaytus" onclick="closeNav()"></div>
    
            <div id="mySidebar" class="sidebar">
                <a href="javascript:void(0)" class="closebtn_first" onclick="closeNav()">&times;</a>
            
                <div class="sidebar-links">
                    <a href="./index.html">Ana səhifə</a>
                    <a href="#">Mağaza</a>
                    <a href="./aboutUs.html">Haqqımızda</a>
                    <a href="./contact.html">Bizimlə əlaqə</a>
                    <a href="./cart.html">Səbət</a>
                    <br><br>
                
                    <div class="language-dropdown">
                        <button class="language-btn">
                          <img src="./assets/img/Earth - 3.svg" alt="language">
                          Azərbaycan
                          <img src="./assets/img/CaretDown.svg" alt="arrowdown" class="arrow-icon">
                        </button>
                        <div class="language-menu">
                          <a href="#">English</a>
                          <a href="#">Русский</a>
                          <a href="#">Türkçe</a>
                        </div>
                      </div>
                      
                </div>
                
            
<div id="mobileAuthControl">
  <button class="sidebar-button" onclick="document.location='mobile_sing.html'">Qeydiyyatdan keç</button>
</div>
            </div>
            
    
            </div>
            <button class="openbtn" onclick="openNav()">☰</button>
    
        </nav>
        <script>
    function openNav() {
      // Open the sidebar and overlay
      document.getElementById("mySidebar").classList.add("open");
      document.getElementById("overlaytus").classList.add("show");
    
      // Disable scrolling by setting the body's and html's overflow to 'hidden'
      document.body.style.overflow = 'hidden';
      document.documentElement.style.overflow = 'hidden'; // This ensures scrolling is disabled for the entire document
    }
    
    function closeNav() {
      // Close the sidebar and overlay
      document.getElementById("mySidebar").classList.remove("open");
      document.getElementById("overlaytus").classList.remove("show");
    
      // Re-enable scrolling by restoring the body's and html's overflow property
      document.body.style.overflow = '';
      document.documentElement.style.overflow = ''; // This restores the default scrolling behavior
    }
    
    const languageBtn = document.querySelector('.language-btn');
    const languageDropdown = document.querySelector('.language-dropdown');
    const arrowIcon = document.querySelector('.arrow-icon'); // выбираем стрелку
    
    languageBtn.addEventListener('click', () => {
        languageDropdown.classList.toggle('open');
        arrowIcon.classList.toggle('rotated'); // переключаем класс для поворота
    });
    
    
        </script>
        
        <div id="overlay"></div>
    
        <div id="popUP"  data-aos="zoom-in-up">
            <button class="close-btn" id="closeBtn">&times;</button>
            <img class="ModalLogo" src="./assets/img/logo.png" alt="logoModal">
            <h2>Freshboxa xoş gəlmisiniz!</h2>
    
            <p>Hesab yaradaraq, təkliflərimizdən yararlana bilərsiniz. Daxil olmaq üçün email ünvanınızı və şifrənizi seçin. Hesabınız varsa, daxil olun.</p>
    
            <div class="switchButtons">
                <button class="active" onclick="switchForm('login')">Daxil ol</button>
                <button onclick="switchForm('register')">Qeydiyyat</button>
            </div>
            
            <!-- Registration Form -->
        <div id="registerForm" class="formContainer" style="display:none;">
            <form id="registerFormAction">
                <label for="full_name">Ad və Soyad</label>
                <div><img src="./assets/img/User.png" alt="NameSurname"><input type="text" id="full_name" name="full_name" placeholder="Ad və Soyad" required></div>
                <label for="register_email">Mail adresiniz</label>
                <div><img src="./assets/img/Message.png" alt="mail"><input type="text" id="register_email" name="email" placeholder="E-mail" required></div>
                <label for="register_password">Parol daxil edin</label>
                <div><img src="./assets/img/Lock password.png" alt="password"><input type="password" id="register_password" name="password" placeholder="Parol" required></div>
                <span>Ən az 8 simvildan ibarət olmalıdır</span>
                <input style="cursor: pointer;" type="submit" value="Qeydiyyatdan keç">
            </form>
            <div id="registerMessage" class="message"></div>
        </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="formContainer" style="display:block;">
                <form>
                    <label>Mail adresiniz</label>
                    <div><img src="./assets/img/Message.png" alt="mail"><input type="text" id="email" placeholder="E-mail" required></div>
                    <label>Parol daxil edin</label>
                    <div><img src="./assets/img/Lock password.png" alt="password"><input type="password" id="password" placeholder="Parol" required></div>
                    <span>Ən az 8 simvildan ibarət olmalıdır</span>
                    <input style="cursor: pointer;" type="submit" value="Daxil ol">
                </form>
            </div>
            
            
    
    
    
    
    
            <div class="linesOr"><div class="line"></div>or<div class="line"></div></div>
            <div class="googleButton"><button><img src="./assets/img/c8c3099ebf31fee900c92a985399f3f1.png" alt="google">Google</button></div>
        </div>
    
        
    
    
        <div class="textHeadButton">
            <h1>
                Məhsullar
            </h1>
            <p>
                Təzə və keyfiyyətli məhsullarımızı kəşf edin. Filtrlərdən istifadə<br> edərək istədiyiniz məhsulu asanlıqla tapın.
            </p>
        </div>
        
      </header>

      <div class="size">
        <div class="page-part">
            <p><a href="./index.html">Ana səhifə</a> <span>/</span> </p>
            <p>Mağaza <span>/</span> <h5>Meyvə</h5></p>
        </div>

        <div class="main">
            <div class="left-bar">
                <div class="word-search">
                    <div class="title-with-line">İndi axtar</div>
                    <div class="search-box">
                        <input type="text" placeholder="Axtar">
                        <button class="orange-circle"><img src="./assets/img/Search_White.svg" alt="seacrWhite"></button>
                    </div>
                </div>

                  
                <div class="filter-dropdown-mobile">
                    <button class="dropdown-toggle-mobile">📂 Kateqoriyalar</button>
                  
                    <div class="filter-left-bar">
                      <div class="title-with-line">Kateqoriyalar</div>
                      <div class="categories">
                        <div class="category-item">
                          <input type="checkbox" id="cat1">
                          <label for="cat1">Meyvə</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat2">
                          <label for="cat2">Tərəvəz</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat3">
                          <label for="cat3">Kənd məhsulları</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat4">
                          <label for="cat4">Salatlar</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat5">
                          <label for="cat5">Ədviyyat</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat6">
                          <label for="cat6">Çərəz</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat7">
                          <label for="cat7">Cem</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat8">
                          <label for="cat8">Quru meyvə</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat9">
                          <label for="cat9">Meyvə</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat10">
                          <label for="cat10">Tərəvəz</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat11">
                          <label for="cat11">Kənd məhsulları</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat12">
                          <label for="cat12">Salatlar</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat13">
                          <label for="cat13">Ədviyyat</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat14">
                          <label for="cat14">Çərəz</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat15">
                          <label for="cat15">Cem</label>
                          <span class="count">20</span>
                        </div>
                        <div class="category-item">
                          <input type="checkbox" id="cat16">
                          <label for="cat16">Quru meyvə</label>
                          <span class="count">20</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  

                  
                  
            </div>
            <div class="right-bar">
                <div class="filter-right-bar">
                    <div><span id="quatity-of-products">26 məhsul</span></div>
                    <div class="custom-dropdown">
                        <select>
                          <option value="azdan-coxa" selected>Azdan çoxa</option>
                          <option value="coxdan-aza">Çoxdan aza</option>
                          <option value="yeniler">Yenilər</option>
                          <option value="endirim">Endirimlilər</option>
                        </select>
                      </div>
                      
                </div>
                <div class="products-container">
<div class="products-card" data-id="123" data-fav="1">
  <div class="imgae-circle">
    <div class="image-container">
      <img src="./assets/img/7683c493753f0d78fecbe07dc26b0e8b.png" alt="productImage">
    </div>
    <div class="favourite-circle" data-id="123" data-fav="1">
      <img src="./assets/img/orangeHerz.svg" alt="orangeHerz">
    </div>
  </div>
  <div class="name-weight">
    <h3>Greyfruit</h3>
    <span>1 kg</span>
  </div>
  <div class="price">
    <span>2.90 man</span>
  </div>
  <div>
    <button role="link" onclick="window.location.href='product-page.html';">İndi sifariş et</button>
  </div>
</div>

                      

                        
                </div>
            </div>
        </div>
      </div>
      <footer>
        <div class="footerLogoText">
            <img class="footerLogoSize" src="./assets/img/logo.png" alt="footerLogo">
            <p>Gündəlik Ehtiyaclarınıza Cavab Verən Zəngin<br> Məhsul Seçimi</p>
        </div>
        <div class="infoFooter">
            <div class="socialIconsLinks">
                <span>Sosial media</span>
                <div class="oneLevelmgText"><a href="#"><img src="./assets/img/lin.png" alt="linkedin">Linkedln</a></div>
                <div class="oneLevelmgText"><a href="https://www.instagram.com/freshbox.az/" target="_blank"><img src="./assets/img/InstagramLogo.png" alt="instagram">Instagram</a></div>
                <div class="oneLevelmgText"><a href="https://www.facebook.com/people/Freshbox/61564707001165/" target="_blank"><img src="./assets/img/FacebookLogo.png" alt="facebook">Facebook</a></div>
            </div>
            <div class="numberMail">
                <span>Əlaqə</span>
                <div><a href="tel:+994 51 505 65 95">+994 51 505 65 95</a></div>
                <div><a href="mailto:mobilingo@gmail.com">test@gmail.com</a></div>
            </div>
        </div>
    
      </footer>
        <div class="underFooter">
            <div class="line"></div>
            <span>Freshbox©agentliyi 2025dən bəri. Bütün hüquqlar qorunur.</span>
        </div>

            <script src="./assets/scripts/index.js"></script>
      <script>
        // Инициализация AOS
             AOS.init();
     
             let modalPage = document.getElementById("modalPage");
             let popUP = document.getElementById("popUP");
             let overlay = document.getElementById("overlay");
             let closeBtn = document.getElementById("closeBtn");
     
             // Функция для открытия модального окна
             function openPopup() {
                 popUP.classList.remove("hide-popup"); // Убираем класс закрытия
                 popUP.classList.add("show-popup");
                 popUP.style.visibility = "visible";
                 overlay.classList.add("active-overlay");
                 AOS.refresh();
             }
     
             // Функция для закрытия модального окна
             function closePopup() {
                 popUP.classList.remove("show-popup");
                 popUP.classList.add("hide-popup");
                 overlay.classList.remove("active-overlay");
     
                 // Убираем окно после завершения анимации
                 setTimeout(() => {
                     popUP.style.visibility = "hidden";
                 }, 300);
             }
     
             // Открытие окна
             modalPage.addEventListener("click", openPopup);
     
             // Закрытие окна только при клике на крестик
             closeBtn.addEventListener("click", closePopup);
     
     
     
       // ФОРМА И АНИМАЦИЯ
     
     // Function to handle the form switch
     function switchForm(formType) {
         // Toggle active button class with smooth transition
         const buttons = document.querySelectorAll('.switchButtons button');
         buttons.forEach(button => {
             button.classList.remove('active'); // Remove active class from all buttons
             button.style.opacity = 0.6; // Set non-active buttons opacity to 0.6
         });
     
         const loginForm = document.getElementById('loginForm');
         const registerForm = document.getElementById('registerForm');
     
         // Apply fade-out and fade-in for forms
         if (formType === 'login') {
             document.querySelector('.switchButtons button:first-child').classList.add('active');
             document.querySelector('.switchButtons button:first-child').style.opacity = 1; // Set active button opacity to 1
     
             // Fade-out the register form before switching
             if (registerForm.style.display === 'block') {
                 registerForm.style.transition = "opacity 0.5s ease-in-out";
                 registerForm.style.opacity = 0; // Fade out register form
                 setTimeout(() => {
                     registerForm.style.display = 'none'; // Hide after fade-out
                 }, 500); // Wait for fade-out to complete
             }
     
             // Fade-in the login form after a delay
             setTimeout(() => {
                 loginForm.style.display = 'block';
                 loginForm.style.transition = "opacity 0.5s ease-in-out";
                 loginForm.style.opacity = 1; // Fade in the login form
             }, 500); // Wait for fade-out to complete before showing login form
     
         } else {
             document.querySelector('.switchButtons button:last-child').classList.add('active');
             document.querySelector('.switchButtons button:last-child').style.opacity = 1; // Set active button opacity to 1
     
             // Fade-out the login form before switching
             if (loginForm.style.display === 'block') {
                 loginForm.style.transition = "opacity 0.5s ease-in-out";
                 loginForm.style.opacity = 0; // Fade out login form
                 setTimeout(() => {
                     loginForm.style.display = 'none'; // Hide after fade-out
                 }, 500); // Wait for fade-out to complete
             }
     
             // Fade-in the register form after a delay
             setTimeout(() => {
                 registerForm.style.display = 'block';
                 registerForm.style.transition = "opacity 0.5s ease-in-out";
                 registerForm.style.opacity = 1; // Fade in the register form
             }, 500); // Wait for fade-out to complete before showing register form
         }
     }
     
     document.addEventListener("DOMContentLoaded", function () {
                      const toggleBtn = document.querySelector(".dropdown-toggle-mobile");
                      const filterBar = document.querySelector(".filter-left-bar");
                  
                      toggleBtn.addEventListener("click", function () {
                        filterBar.classList.toggle("active");
                      });
                    });


                    window.addEventListener("load", function() {
      if (window.innerWidth <= 768) {
        const mobileAuthControl = document.getElementById('mobileAuthControl');
if (mobileAuthControl) {
  mobileAuthControl.innerHTML = `
    <a href="./profile.html">
      <img src="./assets/img/Profile.png" alt="Profile">
    </a>
  `;
}
  }

});


document.addEventListener("DOMContentLoaded", () => {

  document.querySelectorAll(".favourite-circle").forEach(circle => {
    circle.addEventListener("click", async (e) => {
      e.stopPropagation();

        token = localStorage.getItem('token');
        userId = localStorage.getItem('userId');

      if (!token || !userId) {
        showToast("Zəhmət olmasa, əvvəlcə hesabınıza daxil olun", true);
        return;
      }

      const elem = e.currentTarget;
      const productId = elem.getAttribute("data-id");
//      const isFaved = elem.getAttribute("data-fav");

        let isFaved = false;    
      try {
        if (isFaved) {
          // Удалить из избранного
          const res = await fetch('https://api.fresback.squanta.az/api/fave/delete', {
            method: 'DELETE',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({
              user_id: userId,
              product_id: productId
            }),
          });


          if (!res.ok) throw new Error('Xəta baş verdi');

          // Обновить UI
          elem.setAttribute("data-fav", "0");
          elem.querySelector("img").src = "./assets/img/emptyHerz.svg";
          showToast("Sevimlərdən silindi");

        } else {
          // Добавить в избранное

          const res = await fetch('https://api.fresback.squanta.az/api/fave/add', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({
              user_id: userId,
              product_id: productId
            }),
          });
          
          if (res.ok){      //throw new Error('Xəta baş verdi');
          // Обновить UI
          elem.setAttribute("data-fav", "1");
          elem.querySelector("img").src = "./assets/img/orangeHerz.svg";
          showToast("Sevimlərə əlavə edildi");
            }
        }
      } catch (err) {
        console.error("Sevimlər xətası:", err);
        showToast("Xəta baş verdi", true);
      }
    });
  });
});

function showToast(message, isError = false) {
  const toast = document.createElement('div');
  toast.textContent = message;
  toast.style.position = 'fixed';
  toast.style.bottom = '20px';
  toast.style.left = '50%';
  toast.style.transform = 'translateX(-50%)';
  toast.style.padding = '10px 20px';
  toast.style.backgroundColor = isError ? 'red' : 'green';
  toast.style.color = 'white';
  toast.style.borderRadius = '5px';
  toast.style.zIndex = '9999';
  toast.style.fontSize = '14px';
  toast.style.boxShadow = '0 2px 6px rgba(0,0,0,0.3)';
  document.body.appendChild(toast);

  setTimeout(() => {
    toast.remove();
  }, 2000);
}
         </script>
</body>
</html>